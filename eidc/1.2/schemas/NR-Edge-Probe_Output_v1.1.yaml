title: "NR-Edge-Probe Output Schema"
description: "Defines the schema for metrics output by the NR-Edge-Probe component"
version: "1.1.0"
metrics:
  - name: "process.cpu.utilization"
    description: "CPU utilization of the process as a fraction of total CPU capacity"
    type: "gauge"
    unit: "1"
    attributes:
      - name: "pid"
        description: "Process ID"
        type: "int"
        required: true
      - name: "process.executable.name"
        description: "Name of the executable"
        type: "string"
        required: true
      - name: "process.command_line"
        description: "Full command line of the process (may be redacted based on configuration)"
        type: "string"
        required: false
      - name: "host.id"
        description: "Host identifier"
        type: "string"
        required: true
      - name: "cpu.state"
        description: "CPU state (user, system, etc.)"
        type: "string"
        required: false
        enum: ["user", "system", "wait", "idle"]

  - name: "process.memory.utilization"
    description: "Memory utilization of the process as a fraction of total memory"
    type: "gauge"
    unit: "1"
    attributes:
      - name: "pid"
        description: "Process ID"
        type: "int"
        required: true
      - name: "process.executable.name"
        description: "Name of the executable"
        type: "string"
        required: true
      - name: "process.command_line"
        description: "Full command line of the process (may be redacted based on configuration)"
        type: "string"
        required: false
      - name: "host.id"
        description: "Host identifier"
        type: "string"
        required: true

  - name: "process.disk.operations"
    description: "Disk operations performed by the process"
    type: "sum"
    unit: "1"
    attributes:
      - name: "pid"
        description: "Process ID"
        type: "int"
        required: true
      - name: "process.executable.name"
        description: "Name of the executable"
        type: "string"
        required: true
      - name: "host.id"
        description: "Host identifier"
        type: "string"
        required: true
      - name: "direction"
        description: "Direction of disk operations"
        type: "string"
        required: true
        enum: ["read", "write"]
    aggregation:
      temporality: "delta"
      monotonic: true

examples:
  - name: "process.cpu.utilization"
    attributes:
      pid: 1234
      "process.executable.name": "nginx"
      "process.command_line": "nginx -c /etc/nginx/nginx.conf"
      "host.id": "host-abc123"
      "cpu.state": "user"
    value: 0.15

  - name: "process.memory.utilization"
    attributes:
      pid: 1234
      "process.executable.name": "nginx"
      "host.id": "host-abc123"
    value: 0.05

security:
  pii_fields: ["process.command_line"]
  privacy_notes: "Process command lines may contain sensitive information like passwords, API keys, or PII. Filtering or redaction should be applied before exposure."
